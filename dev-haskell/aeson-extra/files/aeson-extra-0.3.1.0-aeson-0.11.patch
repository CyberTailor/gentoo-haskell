diff --git a/aeson-extra.cabal b/aeson-extra.cabal
index d2f1619..db0b0fa 100644
--- a/aeson-extra.cabal
+++ b/aeson-extra.cabal
@@ -31,7 +31,7 @@ library
   ghc-options: -Wall
   build-depends:
       base                     >=4.6  && <4.9
-    , aeson                    >=0.7.0.6 && <0.11
+    , aeson                    >=0.7.0.6 && <0.12
     , aeson-compat             >=0.3.0.0 && <0.4
     , base-compat              >=0.6.0   && <0.10
     , bytestring               >=0.10 && <0.11
@@ -72,7 +72,7 @@ test-suite aeson-extra-test
   ghc-options: -Wall
   build-depends:
       base                     >=4.6  && <4.9
-    , aeson                    >=0.7.0.6 && <0.11
+    , aeson                    >=0.7.0.6 && <0.12
     , aeson-compat             >=0.3.0.0 && <0.4
     , base-compat              >=0.6.0   && <0.10
     , bytestring               >=0.10 && <0.11
diff --git a/src/Data/Aeson/Extra/TH.hs b/src/Data/Aeson/Extra/TH.hs
index 2c2b872..a1cb179 100644
--- a/src/Data/Aeson/Extra/TH.hs
+++ b/src/Data/Aeson/Extra/TH.hs
@@ -1,3 +1,4 @@
+{-# LANGUAGE CPP #-}
 {-# LANGUAGE TemplateHaskell #-}
 {-# OPTIONS_GHC -fno-warn-orphans #-}
 -----------------------------------------------------------------------------
@@ -26,7 +27,7 @@ import qualified Data.Vector as V
 import qualified Data.HashMap.Strict as HM
 
 -- | Create a 'Value' from string representation.
--- 
+--
 -- This is useful in tests.
 --
 -- /Since: aeson-extra-0.3.1.0/
@@ -47,6 +48,7 @@ mkValue' = mkValue . map f
   where f '\'' = '"'
         f x    = x
 
+#if !MIN_VERSION_aeson(0,11,0)
 -- | From 'aeson-extra'
 --
 -- /Since: aeson-extra-0.3.1.0/
@@ -63,3 +65,4 @@ instance Lift Value where
       where a' = V.toList a
     lift (Object o) = [| Object (HM.fromList . map (first T.pack) $ o') |]
       where o' = map (first T.unpack) . HM.toList $ o
+#endif
